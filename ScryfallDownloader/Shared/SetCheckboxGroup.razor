@if (!string.IsNullOrWhiteSpace(App.SetFilter) && Sets.Count(s => s.Code.Contains(App.SetFilter.ToLower()) && s.SetType == Type) == 0) return;

<lead>@Title</lead>
<ul class="list-group">
    @foreach (var set in Sets)
    {
        if (!string.IsNullOrEmpty(App.SetFilter) && !set.Code.Contains(App.SetFilter.ToLower())) continue;

        if (set.SetType == Type)
        {
            <li class="list-group-item">
                <input class="form-check-input me-1" type="checkbox" id="@set.Code-check" @oninput="@(async (e) => await OnCheckboxChanged.InvokeAsync(set.Code))" checked="@App.DownloadSettings.Sets.Contains(set.Code)">
                <label class="form-check-label @(SetState(set.Code.ToLower()))" for="@set.Code-check"><span class="code">@set.Code.ToUpper()</span> - @set.Name <small>@(!string.IsNullOrWhiteSpace(set.MtgoCode) && set.MtgoCode != set.Code ? $"({set.MtgoCode})" : "")</small></label>
            </li>
        }
    }
</ul>
<br />

@code {
    [CascadingParameter]
    public AppState App { get; set; }

    [Parameter]
    public List<Set> Sets { get; set; }

    [Parameter]
    public string Title { get; set; }

    [Parameter]
    public string Type { get; set; }

    [Parameter]
    public EventCallback<string> OnCheckboxChanged { get; set; }

    private string SetState(string code)
    {
        if (App.ForgeData == null || App.ForgeData.MatchedSets == null) return "";

        // Missing sets from a populated MatchedSets list means that there is no Forge edition available for the Scryfall set being iterated
        if (!App.ForgeData.MatchedSets.Any(s => s.ScryfallCode == code)) return "set-unimplemented";

        Console.WriteLine(code);
        var set = App.ForgeData.MatchedSets.First(s => s.ScryfallCode == code);

        switch (set.State)
        {
            case MatchedSetState.Equal:
                return "set-equal";

            case MatchedSetState.Missing:
                return "set-missing";

            case MatchedSetState.Extra:
                return "set-extra";

            default:
                return "";
        }
    }
}
